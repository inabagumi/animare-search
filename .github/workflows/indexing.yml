name: Indexing

on:
  schedule:
  - cron: '45 * * * *'

jobs:
  build:

    name: Run ytc

    runs-on: ubuntu-latest

    steps:
    - name: Download ytc
      env:
        YTC_VERSION: '1.0.0'
      run: |
        mkdir -p bin
        curl -sSL https://github.com/inabagumi/ytc/releases/download/v${YTC_VERSION}/ytc_${YTC_VERSION}_$(uname -s)_$(uname -m).tar.gz | tar xzf - -C bin

    - name: Run ytc
      env:
        GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
        ALGOLIA_API_KEY: ${{ secrets.ALGOLIA_API_KEY }}
        ALGOLIA_APPLICATION_ID: ${{ secrets.ALGOLIA_APPLICATION_ID }}
        ALGOLIA_INDEX_NAME: prod_ANIMARE_SEARCH
      run: |
        ./bin/ytc \
          -channel UC0Owc36U9lOyi9Gx9Ic-4qg \
          -channel UChqYnJlFxlBi6DfRz6jRenQ \
          -channel UC2kyQhzGOB-JPgcQX9OMgEw \
          -channel UCRvpMpzAXBRKJQuk-8-Sdvg
